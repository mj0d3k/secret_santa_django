{% extends "base.html" %}

{% block content %}
    <!-- <link rel="stylesheet" type="text/css" href="static/css/style.css">  -->
    <div class="info-bar">
        <div class="menu-container">
            <a class="menu-link" href="/quick-game/">Quick game</a>
            <span class="user-info">User logged: {{ user.username }}</span>
            {% if user.is_authenticated %}
            <a class="menu-link" href="/logout/">Logout</a>
            <a class="menu-link" href="/change-password/">Change password</a>
            {% else %}
            <a class="menu-link" href="/login/">Login</a>
            {% endif %}
            <a class="menu-link" href="{% url 'delete_account' user.id %}">Delete account</a>
        </div>
    </div>

<div class="main content">

    <style>
        .hidden {
            display: none;
        }
    </style>

    <h1>Your created games</h1>

    {% for event in events_with_draws %}
        <h2>
            Event: {{ event.name }}
            <button class="reveal-button">Reveal</button>
        </h2>
        <ul class="hidden">
            {% for pair in event.giftpair_set.all %}
                <h3>Group: {{ pair.group.name }} Date: {{ pair.date }}</h3>
                <li>
                    <p>Giver: {{ pair.giver.name }} -> Receiver: {{ pair.receiver.name }}</p>
                </li>
            {% endfor %}
        </ul>
    {% endfor %}

    <a href="/new-game/">Create new game</a>

    <h1>Your created events:</h1>
    <ul>
        {% for event in events %}
            <li>{{ event.name }} | {{ event.date }} | {{ event.description }} | {{ event.organizer }}</li>
            <a href="/edit-event/{{ event.id }}/">Edit</a>
            <a href="/delete-event/{{ event.id }}/">Delete</a>
        {% endfor %}
    </ul>
    <a href = "/add-event/">Add event</a>

    <h1>Your created groups:</h1>
    <ul>
        {% for group in groups %}
            <li>{{ group.name }} | {{ group.exchange_date }} | {{ group.price_limit }} | {{ group.creator }}</li>
            <a href="/edit-group/{{ group.id }}/">Edit</a>
            <a href="/delete-group/{{ group.id }}/">Delete</a>
            <a href="/gift-pairs/{{ group.id }}/">Show games</a>
            <ul>
                {% for participant in group.participants.all %}
                    <li>{{ participant.name }} | {{ participant.email }} | {{ participant.wishlist }}</li>
                {% endfor %}
            </ul>
        {% endfor %}
    </ul>
    <a href = "/add-group/">Add group</a>

    <h1>Your created players:</h1>
    <ul>
        {% for person in players %}
            <li>{{ person.name }} | {{ person.email }} | {{ person.wishlist }}</li>
            <a href="/edit-player/{{ person.id }}/">Edit</a>
            <a href="/delete-player/{{ person.id }}/">Delete</a>
        {% endfor %}
    </ul>
    <a href = "/add-player/">Add player</a>

    <h1>Shuffles I participate in:</h1>
    <a href="/my-gift-pairs/">shuffles I participate in</a>

</div>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const buttons = document.querySelectorAll('.reveal-button');

        buttons.forEach(button => {
            button.addEventListener('click', () => {
                const ul = button.parentElement.nextElementSibling;
                if (ul.style.display === 'none' || ul.style.display === '') {
                    ul.style.display = 'block';
                    button.textContent = 'Hide';
                } else {
                    ul.style.display = 'none';
                    button.textContent = 'Reveal';
                }
            });
        });
    });
</script>

{% endblock %}


{% block footer %}
 <p>Secret Santa by me</p>
{% endblock %}